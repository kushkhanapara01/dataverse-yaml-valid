version: 0.1.0
alias: Test987123asd
discoveryPort:
  name: Weather react
  shortDescription: Weather Forecast of the next 7 days for ahmedabad city
  longDescription: >-
    Weather Forecast of the next 7 days for ahmedabad city along with the
    accuracy of the previous forecast
  tags:
    - Weather
    - Forecast
    - City
    - Geospatial
  email: user@maf.ae
  dataTimeRange:
    fromMinDataDate: '2022-04-07'
    toMinDataDate: '2022-04-14'
    timeColumn: '2022-04-07'
  industryDomain: Meteorology
  function: Forecast
  regulatoryFields:
    dataPrivacy: public
    customerInfo: nonPII
    dataOrigin: machineGenerated
    monetaryInfo: nonFinancialData
inputPorts:
  - alias: car_prices_csv
    description: string
    tags: []
    syncType: pull
    type: s3-csv
    dataSetUrn: urn:dv:dataset:90244889-d1bf-4f87-a046-160928e08bd0
    incrementalLoad: true
    incrementalStrategy:
      frequency:
        - keyReference: timeStamp
          mode: range
          interval: -5
    entity:
      path: >-
        s3a://dataverse-byte/sample-data/inputData/PMS_Transaction_Data.csv
      advanceOptions:
        delimiter: '|'
        header: true
      variables:
        - key: timeStamp
          value: date-YYYYMMdd
productState:
  refreshInterval: 0/15 * * * *
  updateStrategy: append
  logicalSchema:
    properties:
      brand:
        type: string
      model:
        type: string
      engine:
        type: string
      year:
        type: string
      location:
        type: string
  encodingType: HASH
  columnsToEncode:
    - gran_period
    - dnname
  partitionColumns:
    - gran_period
    - dnname
transformation:
  - alias: car_price_step_1
    description: step_1
    type: SQL
    sequenceNo: '1'
    query: SELECT * FROM car_prices_csv
    references:
      - alias: car_prices_csv
        sqlReference: car_prices_csv
controlPort:
  dataQualityCheck:
    RecordCountCheck:
      inputPort:
        - referenceAlias: car_prices_csv
          expression: <=
          number: 200
      productState:
        referenceAlias: Test0001
        expression: ==
        number: 100
    UnacceptableTextValueCheck:
      inputPort:
        - referenceAlias: car_prices_csv
          checks:
            - column: dnname
              valueList:
                - dn_name_1
                - dn_name_2
                - dn_name_3
              number: 0.5
              expression: '>='
      productState:
        referenceAlias: Test0001
        checks:
          - column: dnname
            valueList:
              - dn_name_1
              - dn_name_2
              - dn_name_3
            number: 0.5
            expression: '>='
    UniqueCombinationCheck:
      inputPort:
        - referenceAlias: car_prices_csv
          checks:
            - columns:
                - nename
    DistinctValueCountCheck:
      inputPort:
        - referenceAlias: car_prices_csv
          checks:
            - column: gran_period
              number: 30
              expression: '>='
      productState:
        referenceAlias: Test0001
        checks:
          - column: gran_period
            number: 30
            expression: '>='
outputPort:
  subscriptionChannels:
    - channelType: JDBC
      queryType: SQL
