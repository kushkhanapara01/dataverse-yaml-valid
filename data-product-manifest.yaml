version: 0.1.0
alias: Load_final_PMS_State_Profiling
discoveryPort:
  name: PMS_profiling
  shortDescription: ShortDescription
  longDescription: LongDescriptionDescription
  industryDomain: "inDomaiin"
  regulatoryFields:
    dataPrivacy: public
    customerInfo: nonPII
    dataOrigin: machineGenerated
    monetaryInfo: nonFinancialData
  function: abc
  image: https://google.com
  autofillUserinfo: ""
  tags: ['Tag1']
  extra: {}
  createdTs: 1687281186
  updatedTs: 1687281186
inputPorts:
  - alias: PMS_Transactions_1
    description: PMS Transactions
    tags: []
    extra: {}
    syncType: pull
    type: s3-csv
    dataSetUrn: urn:dv:dataset:393c056e-8a0e-4ced-b48d-0af88f9d89ef
    filter: ""
    projection: []
  - alias: PMS_Master_1
    description: PMS Transactions
    tags: []
    extra: {}
    syncType: pull
    type: s3-csv
    dataSetUrn: urn:dv:dataset:504db40f-9d55-4b08-a75c-9d732997f13f
    filter: ""
    projection: []
productState:
  alias: Load final PMS State
  refreshInterval: ""
  retentionVersions: ""
  updateStrategy: append
  logicalSchema:
    properties:
      DNID:
        type: STRING
      DNName:
        type: STRING
      NEName:
        type: STRING
      InitTime:
        type: STRING
      State:
        type: STRING
      City:
        type: STRING
  productStoreState:
    enforceSchemaMethod: Warning
  isProfilingEnabled: true
transformation:
  - alias: Spark_SQL_1
    type: SQL
    description: Join transaction and master
    query: select DNID,DNName,NEName,InitTime,State,City from pmstransaction pmt
      left join pmsmaster pmm on pmt.nename = pmm.sap_id_name
    references:
      - alias: PMS_Transactions_1
        sqlReference: pmstransaction
      - alias: PMS_Master_1
        sqlReference: pmsmaster
outputPort:
  subscriptionChannels:
    - channelType: REST-API
      queryType: SQL
    - channelType: JDBC
      queryType: SQL
controlPort:
  dataQualityRules:
    tableId:
      productState:
        referenceAlias: Load_final_PMS_State_Profiling
        checks: 2865
    enable:
      productState:
        referenceAlias: Load_final_PMS_State_Profiling
        checks: true
    RecordCountCheck:
      productState:
        referenceAlias: Load_final_PMS_State_Profiling
          expression: ">="
          number: 227
    NullValueCheck:
      productState:
        referenceAlias: Load_final_PMS_State_Profiling
        checks:
          - column: NEName
            expression: ==
            number: 100
            stepsToFix: Fix on your own
